---
import { ReadingProgress } from "@/components/blog/ReadingProgress";
import Footer from "@/components/shared/Footer.astro";
import { Navbar } from "@/components/shared/Navbar";
import { baseUrl } from "@/lib/seo";
import BaseLayout from "./BaseLayout.astro";

interface Props {
  title: string;
  description: string;
  ogImage?: string;
  showReadingProgress?: boolean;
  readingTime?: number; // in minutes
  ogType?: "website" | "article";
  articleMeta?: {
    publishedTime: string;
    modifiedTime?: string;
    author: string;
    tags?: string[];
  };
}

const {
  title,
  description,
  ogImage = `${baseUrl}/og-image.png`,
  showReadingProgress = false,
  readingTime = 5,
  ogType,
  articleMeta,
} = Astro.props;

const canonical = `${baseUrl}${Astro.url.pathname}`;

// Spread pattern to avoid passing undefined with exactOptionalPropertyTypes
const baseLayoutProps = {
  title,
  description,
  ogImage,
  canonical,
  ...(ogType ? { ogType } : {}),
  ...(articleMeta ? { articleMeta } : {}),
};
---

<BaseLayout {...baseLayoutProps}>
  <!-- Navbar - React island with client:load -->
  <Navbar client:load />

  <!-- Reading Progress - React island (client-only, no SSR) -->
  {showReadingProgress && (
    <ReadingProgress client:only="react" readingTime={readingTime} />
  )}

  <!-- Main Content -->
  <main id="main-content" class="min-h-screen pt-20">
    <slot />
  </main>

  <!-- Footer - Astro component -->
  <Footer />
</BaseLayout>
